{"mappings":"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","sources":["src/js/gallery1.js","src/js/templates/gallery-main.js"],"sourcesContent":["import '../css/common.css';\n//import axios from \"axios\";\nimport Notiflix from 'notiflix';\nimport throttle from 'lodash.throttle';\nimport galleryCardMainTpl from './templates/gallery-main';\nimport SearchService from './searchService';\nimport LoadMoreBtn from './load-more-btn';\n\nconst searchFormEl = document.querySelector('#search-form');\nconst cardContainerEl = document.querySelector('.gallery');\n\nconst loadMoreBtn = new LoadMoreBtn({ selector: '.load-more', hidden: true });\nconst submitBtn = new LoadMoreBtn({ selector: '.submit-btn', hidden: false })\nconst searchService = new SearchService();\n\nlet lastScroll = 0;\n\nsearchFormEl.addEventListener('submit', onSearch);\nloadMoreBtn.button.addEventListener('click', onLoadMore);\nwindow.addEventListener('scroll', throttle(onScroll, 1000));\n\nasync function onSearch(e) {\n    e.preventDefault();\n    clearCardcontainer();\n\n    searchService.word = e.currentTarget.elements.searchQuery.value.trim();\n    \n    if (isSearchQueryAmpty(searchService.word)) {\n        return;\n    }; \n\n    searchService.resetPage();\n    searchService.resetViewedPhotoes();\n    submitBtn.disabled();\n    loadMoreBtn.hide();\n\n    try {\n        const { hits, totalHits } = await searchService.fetchArticles();\n\n        if (isArrayOfDataAmpty(hits.length)) {\n            return;\n        }\n\n        Notiflix.Notify.success(`Hooray! We found ${totalHits} images.`);\n\n        appendPhotoCardMarkup(hits);\n        submitBtn.enable();\n        loadMoreBtn.show();\n        loadMoreBtn.enable();\n\n        lessPhotoesThanPerpageInTheFirstRequest(totalHits, searchService.perPage);       \n        \n    } catch (error) {\n        onSomeError(error);\n    }\n}\n\nasync function onLoadMore() {\n    loadMoreBtn.disabled();\n\n    try {\n        const { hits, totalHits } = await searchService.fetchArticles();\n        \n        loadMoreBtn.enable();\n        appendPhotoCardMarkup(hits);\n        endOfCollection(totalHits, searchService.viewedPhotoes, searchService.perPage);\n    \n    } catch (error) {\n        onSomeError(error);\n    }\n}\n\nfunction scrollPosition() {\n    return window.pageYOffset || document.documentElement.scroll;\n}\n\nfunction onScroll() {\n    if (scrollPosition() > lastScroll) {\n        if (window.pageYOffset + document.documentElement.clientHeight >= getDocHeight() - 20\n        && loadMoreBtn.button.classList.contains('is-hidden')) {   \n            Notiflix.Notify.info(\"We're sorry, but you've reached the end of search results.\");\n        };\n    };\n    lastScroll = scrollPosition(); \n}\n\nfunction isSearchQueryAmpty(searchQuery) {\n    if (searchQuery === '') {\n        loadMoreBtn.hide();\n        Notiflix.Notify.warning(\"Please, enter a search query!\");\n\n        return true;\n    };\n}\n\nfunction isArrayOfDataAmpty(length) {\n    if (length === 0) {\n        loadMoreBtn.hide();\n        submitBtn.enable();\n        Notiflix.Notify.failure(\"Sorry, there are no images matching your search query. Please try again.\");\n        \n        return true;\n    };\n}\n\nfunction onSomeError(error) {\n    Notiflix.Notify.info(\"We're sorry, try ones more.\");\n    submitBtn.enable();\n    console.log(error);\n}\n\nfunction appendPhotoCardMarkup(hits) {\n    const makePhotoCards = hits\n        .map(galleryCardMainTpl)\n        .join('');\n    \n    cardContainerEl.insertAdjacentHTML('beforeend', makePhotoCards);\n}\n\nfunction clearCardcontainer() {\n    cardContainerEl.innerHTML = '';\n}\n\nfunction endOfCollection(total, shown, per) {\n    if (total <= shown || shown < per) {\n        loadMoreBtn.hide();\n        //setTimeout(() => {\n         //   Notiflix.Notify.info(\"We're sorry, but you've reached the end of search results.\");\n        //}, 1000);\n    }\n}\n\nfunction lessPhotoesThanPerpageInTheFirstRequest(total, per) {\n    if (total <= per && total !== 0) {\n        loadMoreBtn.hide();\n    }\n}\n\nfunction getDocHeight() {\n    return Math.max(\n        document.body.scrollHeight, document.documentElement.scrollHeight,\n        document.body.offsetHeight, document.documentElement.offsetHeight,\n        document.body.clientHeight, document.documentElement.clientHeight\n    );\n}","export default function galleryCardMainTpl(image) {\n    const { webformatURL, largeImageURL, tags, likes, views, comments, downloads } = image;\n    \n    return `\n            <div class=photo-card>\n                <img class=photo-card_image src=${webformatURL} alt=${tags} loading=\"lazy\" />\n                <div class=info>\n                    <p class=info-item>\n                    <b>Likes ${likes}</b>\n                    </p>\n                    <p class=info-item>\n                    <b>Views ${views}</b>\n                    </p>\n                    <p class=info-item>\n                    <b>Comments ${comments}</b>\n                    </p>\n                    <p class=info-item>\n                    <b>Downloads ${downloads}</b>\n                    </p>\n                </div>\n            </div>\n        `;\n}"],"names":["$bpxeT","parcelRequire","$2fceeee9330c7344$export$2e2bcd8739ae039","image","webformatURL","tags","largeImageURL","likes","views","comments","downloads","concat","$9ca71b378da6ca67$var$searchFormEl","document","querySelector","$9ca71b378da6ca67$var$cardContainerEl","$9ca71b378da6ca67$var$loadMoreBtn","$gGuPt","default","selector","hidden","$9ca71b378da6ca67$var$submitBtn","$9ca71b378da6ca67$var$searchService","$h3pWP","$9ca71b378da6ca67$var$lastScroll","$9ca71b378da6ca67$var$_onSearch","$parcel$interopDefault","$2TvXO","mark","_callee","e","ref","hits","totalHits","preventDefault","$9ca71b378da6ca67$var$clearCardcontainer","word","currentTarget","elements","searchQuery","value","trim","$9ca71b378da6ca67$var$isSearchQueryAmpty","resetPage","resetViewedPhotoes","disabled","hide","fetchArticles","_ctx","sent","$9ca71b378da6ca67$var$isArrayOfDataAmpty","length","$6JpON","Notify","success","$9ca71b378da6ca67$var$appendPhotoCardMarkup","enable","show","$9ca71b378da6ca67$var$lessPhotoesThanPerpageInTheFirstRequest","perPage","$9ca71b378da6ca67$var$onSomeError","t0","apply","this","arguments","$9ca71b378da6ca67$var$_onLoadMore","$9ca71b378da6ca67$var$endOfCollection","viewedPhotoes","$9ca71b378da6ca67$var$scrollPosition","window","pageYOffset","documentElement","scroll","warning","failure","error","info","console","log","makePhotoCards","map","join","insertAdjacentHTML","innerHTML","total","shown","per","addEventListener","button","$dCfNN","clientHeight","Math","max","body","scrollHeight","offsetHeight","classList","contains"],"version":3,"file":"gallery1.eb9306fe.js.map"}