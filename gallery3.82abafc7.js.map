{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,0GASMC,EAAeC,SAASC,cAAc,gBACtCC,EAAkBF,SAASC,cAAc,YAEzCE,EAAY,IAAI,EAAAC,EAAAC,SAAY,CAAEC,SAAU,cAAeC,QAAQ,IAC/DC,EAAgB,IAAI,EAAAC,EAAAJ,S,SAgCXK,I,OAAAA,EAAfC,EAAAd,EAAA,CAAAc,EAAAC,GAAAC,MAAA,SAAAC,EAA4BC,G,IAEQC,EAApBC,EAAMC,EAURC,E,2FAV4BX,EAAcY,gB,UAApBJ,EAAmCK,EAAAC,KAAvDL,EAAoBD,EAApBC,KAAMC,EAAcF,EAAdE,WAEVK,EAAmBN,EAAKO,QAAO,C,gDAInCC,EAA0BP,GAC1BQ,EAAsBT,GACtBd,EAAUwB,UAEJR,EAAYnB,SAASC,cAAc,yBAGrCc,EAAIa,QAAQT,G,kDAIhBU,EAAWR,EAAAS,I,2DAnBOC,MAAAC,KAAAC,U,CA6B1B,SAASR,EAA0BP,GAC/BP,EAAAuB,GAASC,OAAOC,QAAQ,oBAA8BC,OAAVnB,EAAU,Y,CAG1D,SAASQ,EAAsBT,GAC3B,IAAMqB,EAAiBrB,EAClBsB,IAAIC,EAAAnC,SACJoC,KAAK,IAEVvC,EAAgBwC,mBAAmB,YAAaJ,GAElC,IAAI3B,EAAAgC,GAAJ,CAAmB,cACzBC,S,CAoBZ,SAASrB,EAAmBC,GACxB,GAAe,IAAXA,EAIA,OAHArB,EAAUwB,SACVhB,EAAAuB,GAASC,OAAOU,QAAQ,6EAEjB,C,CAIf,SAAShB,EAAYiB,GACjBnC,EAAAuB,GAASC,OAAOY,KAAK,+BACrB5C,EAAUwB,SACVqB,QAAQC,IAAIH,E,CArGhB/C,EAAamD,iBAAiB,UAE9B,SAAkBC,GAMd,GALAA,EAAEC,iBAqGN,WACIlD,EAAgBmD,UAAY,E,CArG5BC,GAEA9C,EAAc+C,KAAOJ,EAAEK,cAAcC,SAASC,YAAYC,MAAMC,OA2EpE,SAA4BF,GACxB,GAAoB,KAAhBA,EAGA,OAFA/C,EAAAuB,GAASC,OAAO0B,QAAQ,kCAEjB,C,CA7EPC,CAAmBtD,EAAc+C,MACjC,OAGJ/C,EAAcuD,YACdvD,EAAcwD,qBACd7D,EAAU8D,WAEV,IAAIC,EAAmB,IAAIC,sBAAqB,SAAAC,EAAUC,G,IAARC,E,UAAK,GAC/CA,EAAMC,iBACNF,EAASG,UAAUF,EAAMG,Q,SAUT1D,GAAbL,EAAWqB,MAAAC,KAAAC,U,CARdyC,CAAYR,GACZ1D,EAAcmE,gB,GAEnB,CACCC,UAAW,G","sources":["src/js/gallery3.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport '../css/common.css';\nimport galleryCardAdditionalTpl from './templates/gallery-additional';\nimport throttle from 'lodash.throttle';\nimport SearchService from './searchService';\nimport LoadMoreBtn from './load-more-btn';\n\nconst searchFormEl = document.querySelector('#search-form');\nconst cardContainerEl = document.querySelector('.gallery');\n\nconst submitBtn = new LoadMoreBtn({ selector: '.submit-btn', hidden: false })\nconst searchService = new SearchService();\n\nlet lastScroll = 0;\n\nsearchFormEl.addEventListener('submit', onSearch);\n\nfunction onSearch(e) {\n    e.preventDefault();\n    clearCardcontainer();\n\n    searchService.word = e.currentTarget.elements.searchQuery.value.trim();\n    \n    if (isSearchQueryAmpty(searchService.word)) {\n        return;\n    }; \n\n    searchService.resetPage();\n    searchService.resetViewedPhotoes();\n    submitBtn.disabled();\n\n    let infiniteObserver = new IntersectionObserver(([entry], observer) => {\n        if (entry.isIntersecting) {\n            observer.unobserve(entry.target);\n\n            loadPhotoes(infiniteObserver);\n            searchService.incrementPage();\n        }\n    }, {\n        threshold: 1,\n    });\n}\n\nasync function loadPhotoes (obs) {\n        try {\n        const { hits, totalHits } = await searchService.fetchArticles();\n\n        if (isArrayOfDataAmpty(hits.length)) {\n            return;\n        }\n\n        totalFoundPicturesMessage(totalHits);\n        appendPhotoCardMarkup(hits);\n        submitBtn.enable();  \n        \n        const lastPhoto = document.querySelector('.gallery:last-child');\n         \n        if (lastPhoto) {\n            obs.observe(lastPhoto);\n        }\n        \n    } catch (error) {\n        onSomeError(error);\n    };  \n}\n\n\n\nfunction endOfResultsMessage() {\n    Notiflix.Notify.info(\"We're sorry, but you've reached the end of search results.\");\n}\n\nfunction totalFoundPicturesMessage(totalHits) {\n    Notiflix.Notify.success(`Hooray! We found ${totalHits} images.`);\n}\n\nfunction appendPhotoCardMarkup(hits) {\n    const makePhotoCards = hits\n        .map(galleryCardAdditionalTpl)\n        .join('');\n    \n    cardContainerEl.insertAdjacentHTML('beforeend', makePhotoCards);\n\n    let gallery = new SimpleLightbox('.gallery a');\n    gallery.refresh();\n}\n\nfunction smoothScroll(className) {\n    const { height: cardHeight } = document.querySelector(`.${className}`).firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n        top: cardHeight * 2,\n        behavior: \"smooth\",\n    });\n}\n\nfunction isSearchQueryAmpty(searchQuery) {\n    if (searchQuery === '') {\n        Notiflix.Notify.warning(\"Please, enter a search query!\");\n\n        return true;\n    };\n}\n\nfunction isArrayOfDataAmpty(length) {\n    if (length === 0) {\n        submitBtn.enable();\n        Notiflix.Notify.failure(\"Sorry, there are no images matching your search query. Please try again.\");\n        \n        return true;\n    };\n}\n\nfunction onSomeError(error) {\n    Notiflix.Notify.info(\"We're sorry, try ones more.\");\n    submitBtn.enable();\n    console.log(error);\n}\n\nfunction clearCardcontainer() {\n    cardContainerEl.innerHTML = '';\n}\n\n\n\n"],"names":["$bpxeT","parcelRequire","$2c81a8fded229245$var$searchFormEl","document","querySelector","$2c81a8fded229245$var$cardContainerEl","$2c81a8fded229245$var$submitBtn","$gGuPt","default","selector","hidden","$2c81a8fded229245$var$searchService","$h3pWP","$2c81a8fded229245$var$_loadPhotoes","$parcel$interopDefault","$2TvXO","mark","_callee","obs","ref","hits","totalHits","lastPhoto","fetchArticles","_ctx","sent","$2c81a8fded229245$var$isArrayOfDataAmpty","length","$2c81a8fded229245$var$totalFoundPicturesMessage","$2c81a8fded229245$var$appendPhotoCardMarkup","enable","observe","$2c81a8fded229245$var$onSomeError","t0","apply","this","arguments","$6JpON","Notify","success","concat","makePhotoCards","map","$ag7wj","join","insertAdjacentHTML","$5IjG7","refresh","failure","error","info","console","log","addEventListener","e","preventDefault","innerHTML","$2c81a8fded229245$var$clearCardcontainer","word","currentTarget","elements","searchQuery","value","trim","warning","$2c81a8fded229245$var$isSearchQueryAmpty","resetPage","resetViewedPhotoes","disabled","infiniteObserver","IntersectionObserver","param","observer","entry","isIntersecting","unobserve","target","$2c81a8fded229245$var$loadPhotoes","incrementPage","threshold"],"version":3,"file":"gallery3.82abafc7.js.map"}