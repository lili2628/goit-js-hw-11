{"mappings":"qhBAAA,IAAAA,EAAAC,EAAA,S,mEASA,MAAMC,EAAeC,SAASC,cAAc,gBACtCC,EAAkBF,SAASC,cAAc,YAEzCE,EAAY,IAAI,EAAAC,EAAAC,SAAY,CAAEC,SAAU,cAAeC,QAAQ,IAC/DC,EAAgB,IAAI,EAAAC,EAAAJ,SAI1BN,EAAaW,iBAAiB,UAE9B,SAAkBC,GAMd,GALAA,EAAEC,iBAqGN,WACIV,EAAgBW,UAAY,E,CArG5BC,GAEAN,EAAcO,KAAOJ,EAAEK,cAAcC,SAASC,YAAYC,MAAMC,OA2EpE,SAA4BF,GACxB,GAAoB,KAAhBA,EAGA,OAFAG,EAAAxB,GAASyB,OAAOC,QAAQ,kCAEjB,C,CA7EPC,CAAmBhB,EAAcO,MACjC,OAGJP,EAAciB,YACdjB,EAAckB,qBACdvB,EAAUwB,WAEV,IAAIC,EAAmB,IAAIC,sBAAqB,EAAEC,GAAQC,KAClDD,EAAME,iBACND,EAASE,UAAUH,EAAMI,QAUrCC,eAA4BC,GACpB,IACA,MAAMC,KAAEA,EAAIC,UAAEA,SAAoB9B,EAAc+B,gBAEhD,GAyDR,SAA4BC,GACxB,GAAe,IAAXA,EAIA,OAHArC,EAAUsC,SACVpB,EAAAxB,GAASyB,OAAOoB,QAAQ,6EAEjB,C,CA9DHC,CAAmBN,EAAKG,QACxB,QAwBZ,SAAmCF,GAC/BjB,EAAAxB,GAASyB,OAAOsB,QAAQ,oBAAoBN,Y,CAtBxCO,CAA0BP,GAyBlC,SAA+BD,GAC3B,MAAMS,EAAiBT,EAClBU,IAAIC,EAAA3C,SACJ4C,KAAK,IAEV/C,EAAgBgD,mBAAmB,YAAaJ,GAElC,IAAIzB,EAAA8B,GAAJ,CAAmB,cACzBC,S,CAhCJC,CAAsBhB,GACtBlC,EAAUsC,SAEV,MAAMa,EAAYtD,SAASC,cAAc,uBAErCqD,GACAlB,EAAImB,QAAQD,E,CAGlB,MAAOE,IAoDb,SAAqBA,GACjBnC,EAAAxB,GAASyB,OAAOmC,KAAK,+BACrBtD,EAAUsC,SACViB,QAAQC,IAAIH,E,CAtDRI,CAAYJ,E,EA3BRK,CAAYjC,GACZpB,EAAcsD,gB,GAEnB,CACCC,UAAW,G","sources":["src/js/gallery3.js"],"sourcesContent":["import Notiflix from 'notiflix';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport '../css/common.css';\nimport galleryCardAdditionalTpl from './templates/gallery-additional';\nimport throttle from 'lodash.throttle';\nimport SearchService from './searchService';\nimport LoadMoreBtn from './load-more-btn';\n\nconst searchFormEl = document.querySelector('#search-form');\nconst cardContainerEl = document.querySelector('.gallery');\n\nconst submitBtn = new LoadMoreBtn({ selector: '.submit-btn', hidden: false })\nconst searchService = new SearchService();\n\nlet lastScroll = 0;\n\nsearchFormEl.addEventListener('submit', onSearch);\n\nfunction onSearch(e) {\n    e.preventDefault();\n    clearCardcontainer();\n\n    searchService.word = e.currentTarget.elements.searchQuery.value.trim();\n    \n    if (isSearchQueryAmpty(searchService.word)) {\n        return;\n    }; \n\n    searchService.resetPage();\n    searchService.resetViewedPhotoes();\n    submitBtn.disabled();\n\n    let infiniteObserver = new IntersectionObserver(([entry], observer) => {\n        if (entry.isIntersecting) {\n            observer.unobserve(entry.target);\n\n            loadPhotoes(infiniteObserver);\n            searchService.incrementPage();\n        }\n    }, {\n        threshold: 1,\n    });\n}\n\nasync function loadPhotoes (obs) {\n        try {\n        const { hits, totalHits } = await searchService.fetchArticles();\n\n        if (isArrayOfDataAmpty(hits.length)) {\n            return;\n        }\n\n        totalFoundPicturesMessage(totalHits);\n        appendPhotoCardMarkup(hits);\n        submitBtn.enable();  \n        \n        const lastPhoto = document.querySelector('.gallery:last-child');\n         \n        if (lastPhoto) {\n            obs.observe(lastPhoto);\n        }\n        \n    } catch (error) {\n        onSomeError(error);\n    };  \n}\n\n\n\nfunction endOfResultsMessage() {\n    Notiflix.Notify.info(\"We're sorry, but you've reached the end of search results.\");\n}\n\nfunction totalFoundPicturesMessage(totalHits) {\n    Notiflix.Notify.success(`Hooray! We found ${totalHits} images.`);\n}\n\nfunction appendPhotoCardMarkup(hits) {\n    const makePhotoCards = hits\n        .map(galleryCardAdditionalTpl)\n        .join('');\n    \n    cardContainerEl.insertAdjacentHTML('beforeend', makePhotoCards);\n\n    let gallery = new SimpleLightbox('.gallery a');\n    gallery.refresh();\n}\n\nfunction smoothScroll(className) {\n    const { height: cardHeight } = document.querySelector(`.${className}`).firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n        top: cardHeight * 2,\n        behavior: \"smooth\",\n    });\n}\n\nfunction isSearchQueryAmpty(searchQuery) {\n    if (searchQuery === '') {\n        Notiflix.Notify.warning(\"Please, enter a search query!\");\n\n        return true;\n    };\n}\n\nfunction isArrayOfDataAmpty(length) {\n    if (length === 0) {\n        submitBtn.enable();\n        Notiflix.Notify.failure(\"Sorry, there are no images matching your search query. Please try again.\");\n        \n        return true;\n    };\n}\n\nfunction onSomeError(error) {\n    Notiflix.Notify.info(\"We're sorry, try ones more.\");\n    submitBtn.enable();\n    console.log(error);\n}\n\nfunction clearCardcontainer() {\n    cardContainerEl.innerHTML = '';\n}\n\n\n\n"],"names":["$7Y9D8","parcelRequire","$be859a28b3138557$var$searchFormEl","document","querySelector","$be859a28b3138557$var$cardContainerEl","$be859a28b3138557$var$submitBtn","$2cvPU","default","selector","hidden","$be859a28b3138557$var$searchService","$aYq7L","addEventListener","e","preventDefault","innerHTML","$be859a28b3138557$var$clearCardcontainer","word","currentTarget","elements","searchQuery","value","trim","$parcel$interopDefault","Notify","warning","$be859a28b3138557$var$isSearchQueryAmpty","resetPage","resetViewedPhotoes","disabled","infiniteObserver","IntersectionObserver","entry","observer","isIntersecting","unobserve","target","async","obs","hits","totalHits","fetchArticles","length","enable","failure","$be859a28b3138557$var$isArrayOfDataAmpty","success","$be859a28b3138557$var$totalFoundPicturesMessage","makePhotoCards","map","$hDK3b","join","insertAdjacentHTML","$fZKcF","refresh","$be859a28b3138557$var$appendPhotoCardMarkup","lastPhoto","observe","error","info","console","log","$be859a28b3138557$var$onSomeError","$be859a28b3138557$var$loadPhotoes","incrementPage","threshold"],"version":3,"file":"gallery3.3daa6af6.js.map"}